/*
 MIT

 @uses     PubSub.js  -  https://github.com/Groxx/PubSub
           @copyright 2011 by Steven Littiebrant

 2011 by Steven Littiebrant
*/
var \u03c0=\u03c0||{};\u03c0.core=\u03c0.core||{_loaded:!1,_ns:"core"};\u03c0.callback=\u03c0.callback||{_loaded:!1,_ns:"callback"};\u03c0.session=\u03c0.session||{_loaded:!1,_ns:"session"};\u03c0.events=\u03c0.events||{_loaded:!1,_ns:"events"};\u03c0.tasks=\u03c0.tasks||{_loaded:!1,_ns:"tasks"};\u03c0.timer=\u03c0.timer||{_loaded:!1,_ns:"timer"};\u03c0.srv=\u03c0.srv||{_loaded:!1,_ns:"srv"};\u03c0.app=\u03c0.app||{_loaded:!1,_ns:"app"};\u03c0.pcl=\u03c0.pcl||{_loaded:!1,_ns:"pcl"};
\u03c0.system=\u03c0.system||{_loaded:!1,_ns:"system"};\u03c0.debug=\u03c0.debug||{_loaded:!1,_ns:"debug"};\u03c0.io=\u03c0.io||{_loaded:!1,_ns:"io"};\u03c0.file=\u03c0.file||{_loaded:!1,_ns:"file"};\u03c0.ext=\u03c0.ext||{_loaded:!1,_ns:"ext"};\u03c0.fn=\u03c0.fn||{_loaded:!1,_ns:"fn"};\u03c0.lib=\u03c0.lib||{_loaded:!1,_ns:"lib"};\u03c0.util=\u03c0.util||{_loaded:!1,_ns:"util"};\u03c0.plugins=\u03c0.plugins||{_loaded:!1,_ns:"plugins"};\u03c0.maverick=\u03c0.maverick||{_loaded:!1,_ns:"maverick"};
\u03c0._const=\u03c0._const||{PI_ROOT:"assets/js/",LIB_ROOT:"../../assets/js/",API_ROOT:"/api/",LOG_URL:"/api/log/",TWEEN_TIME:.2,DEFAULT_TIMEOUT:30};\u03c0.loaded=\u03c0.loaded||{};var pi=\u03c0;
\u03c0.core.callback=\u03c0.core.callback||{__id:0,__prefix:"___callback",__items:{},add:function(a){if("function"!=typeof a)return pi.log("Error: Tried to add non-function as callback:",a),!1;var b=\u03c0.core.callback,c=b.__prefix+(b.__id++).toString(16);b.__items[c]={callback:a,timestamp:(new Date).getTime()};return c},call:function(a,b){var c=\u03c0.core.callback.__items[a],d=!1;if(c&&"function"==typeof c.callback)return d=c.callback.call(this,b);pi.log("Error invoking callback: "+a,c)}};
\u03c0.callback=\u03c0.core.callback;\u03c0.callback._loaded=!0;\u03c0.events=\u03c0.events||{};
var PubSub=function(a,b,c){var d="_sub",f={},g=!1,e=this,k=function(a,b){for(var c=0;c<a[d].length;c++)if(void 0===b||null===b||a[d][c]===b)a[d].splice(c,1),c--},l=function(a,b){for(sub in a)"object"==typeof a[sub]&&sub!==d&&a.hasOwnProperty(sub)&&l(a[sub],b);k(a,b)};"string"==typeof c?d=c:"string"==typeof b?d=b:"string"==typeof a&&(d=a);"boolean"==typeof b?g=b:"boolean"==typeof a&&(g=a);if("object"==typeof a||"function"==typeof a)e=a;f[d]=[];e.publish=function(a,b){var c;a=a||"";var n=null,h=f,k=
[],l=!1,n=2<arguments.length?Array.prototype.slice.apply(arguments,[1]):[b];c=a.split(".");g&&n.push(c);k.push(h);for(var m=0;m<c.length&&""!==c[m]&&void 0!==h[c[m]];m++)h=h[c[m]],k.push(h);for(;c=k.pop();){for(h=0;h<c[d].length;h++)!1===c[d][h].apply(this,n)&&(l=!0);if(l)break}return e};e.subscribe=function(a,b){var c,g=f;c=(a||"").split(".");for(var h=0;h<c.length&&""!==c[h];h++)g[c[h]]||(g[c[h]]={},g[c[h]][d]=[]),g=g[c[h]];g[d].push(b);return e};e.unsubscribe=function(a,b,c){var d=f;if(a=a||""){a=
a.split(".");for(var g=0;g<a.length&&""!==a[g];g++){if(void 0===d[a[g]])return;d=d[a[g]]}}"boolean"==typeof b&&(c=b,b=null);c?l(d,b):k(d,b);return e}};PubSub(\u03c0.events,!1);\u03c0.events.trigger=function(a,b,c){a=a||!1;b=b||null;var d=c||window;if(!a)return!1;!0===pi.browser.isIe()?pi.events.publish(a,b,c):b?d.dispatchEvent(new CustomEvent(a,{detail:b})):d.dispatchEvent(new CustomEvent(a))};\u03c0.events.emit=\u03c0.events.trigger;\u03c0.events.dispatch=\u03c0.events.trigger;
\u03c0.events._loaded=!0;\u03c0.browser=\u03c0.browser||{};\u03c0.browser.isIe=function(a){return RegExp("msie"+(isNaN(a)?"":"\\s"+a),"i").test(navigator.userAgent)};\u03c0.browser.isMobile=function(){return/ip(hone|od|ad)|android|blackberry.*applewebkit|bb1\d.*mobile/i.test(navigator.userAgent)};\u03c0.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};
\u03c0.isObject=function(a){return a&&a instanceof Object&&-1==a.constructor.toString().indexOf("Array")};\u03c0.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)};\u03c0.strPad=function(a,b,c,d){c=c||"&nbsp;";b=b||!1;d=d||!1;var f=0,g=a=a.toString(),f=b-a.length;if(0>=f||!1===b)return a;for(;f--;)g=d?c+g:g+c;return g};
\u03c0.basename=function(a,b){a=a||null;b=b||"";var c="",c=-1;a.lastIndexOf("/")==a.length-1&&a.length--;c=a.lastIndexOf("/");c=-1<c?a.substring(c+1):a;if(b&&"string"===typeof b){var d=c.length;c.lastIndexOf(b)==d-b.length&&(c=c.substring(0,c.lastIndexOf(b)))}return c};\u03c0.gettext=function(a){a=document.getElementById(a)||null;return null===a?!1:a.textContent?a.textContent:a.innerText?a.innerText:!1};
\u03c0.settext=function(a,b){var c=document.getElementById(a)||null;b=b||"";if(null===c)return!1;c.textContent?c.textContent=b:c.innerText&&(c.innerText=b);return!0};\u03c0.addtext=function(a,b,c){b=b||"";c=c||!1;var d=document.getElementById(a)||null;if(!(d||b||a))return!1;c?d.textContent?d.textContent=b+d.textContent:d.innerText&&(d.innerText=b+d.innerText):d.textContent?d.textContent+=b:d.innerText&&(d.innerText+=b)};
\u03c0.heap=\u03c0.heap||{__vars:[],add:function(a,b){a=a||null;var c=\u03c0.heap;if(null!==a&&null!==(b||null)){var d=a;a=a.replace(/\./g,"-");c.__vars[a]={__e:document.getElementById(a)||null,address:d,get element(){return this.__e},set element(a){this.__e=(\u03c0.isElement(a)?a:document.getElementById(a))||null},get value(){return this.__e?this.__e.textContent?this.__e.textContent:this.__e.innerText?this.__e.innerText:this.__e.innerHTML||"":null},set value(a){if(!this.__e)return!1;this.__e.textContent?
this.__e.textContent=a:this.__e.innerText?this.__e.innerText=a:this.__e.innerHTML=a}}}else return!1},item:function(a){var b=\u03c0.heap;a=a||!1;return!1===a?!1:b.__vars[a]||b.__vars[a.replace(/\./g,"-")]||null},remove:function(a){if(\u03c0.heap.__vars[a])\u03c0.heap.__vars[a]=null;else if(\u03c0.heap.__vars[a.replace(/\./g,"-")])\u03c0.heap.__vars[a.replace(/\./g,"-")]=null;else return!1;return!0},clear:function(){for(var a=null;0<\u03c0.heap.__vars.length;)(a=\u03c0.heap.__vars.pop())&&"function"==
typeof a.clear&&a.clear.call(a)}};\u03c0.logArray=function(a){for(var b=a.length;b--;)pi.log(pi.strPad(b,4," ")+" : "+a[b])};\u03c0.logObject=function(a){pi.log("Object : ",a)};\u03c0.log=function(a,b){b?console.log(a,b):\u03c0.isArray(a)?pi.logArray(a):"object"===typeof a?\u03c0.logObject(a):console.log(a);pi.app.console&&"function"==typeof pi.app.console.log&&pi.app.console.log(a,b)};
\u03c0.search=function(a,b,c,d,f){var g=null;f=f||!1;a=a||null;b=b||null;d=d||1;c=c||0;if(!b||!a)return pi.log("no obj"),!1;for(var e in b){if(0===c||1===c)if(d){if(e==a)return b[e]}else if(-1<e.indexOf(a))return b[e];if("object"==typeof b[e])if(g=pi.search(a,b[e],c,d,f))break;else continue;if(b.hasOwnProperty(e)&&(2===c||0===c)){if(1==d&&b[e].toString()==a||0==d&&-1!=b[e].toString().indexOf(a))return b;g=!1}}return g};
\u03c0.search2=function(a,b,c,d,f){var g=null;f=f||!1;a=a||null;b=b||null;d=d||1;c=c||0;if(!b||!a)return!1;for(var e in b){if(0===c||1===c)if(d){if(e==a)return b[e]}else if(-1<e.indexOf(a))return b[e];if("object"==typeof b[e])if(g=pi.search2(a,b[e],c,d,f))break;else continue;if(b.hasOwnProperty(e)&&(2===c||0===c)){if(1==d&&b[e].toString()==a||0==d&&-1!=b[e].toString().indexOf(a))return b;g=null}}return g};
\u03c0.isNode=function(a){return"object"==typeof Node?a instanceof Node:a&&"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName};\u03c0.isElement=function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1==a.nodeType&&"string"==typeof a.nodeName};\u03c0.polyfill=function(a,b){a=a||null;b=b||window;a in b||pi.require("polyfill."+a.toLowerCase())};
\u03c0.inject=function(a,b){var c=b||document.body,d=document.createDocumentFragment(),f=document.createElement("div");f.innerHTML=a;d.appendChild(f);b&&b!=document.body&&\u03c0.clear(b);return c.appendChild(d)};\u03c0.clear=function(a){var b=0;if(!\u03c0.isElement(a))return!1;for(;a.firstChild;)a.removeChild(a.firstChild),b++;return b};
\u03c0.clone=function(a){var b=Object.create(Object.getPrototypeOf(a));Object.getOwnPropertyNames(a).forEach(function(c){Object.defineProperty(b,c,Object.getOwnPropertyDescriptor(a,c))});return b};\u03c0.create=function(a){var b=function(){};b.prototype=a;return new b};\u03c0.copy=function(a,b){a=a||!1;b=b||!1;var c=null;if("string"==typeof a)try{a=JSON.parse(a)}catch(d){return pi.log('Error in JSON.parse("'+a+'")',d),null}var c={},f;for(f in a)!1!==b&&-1<b.indexOf(f)||(c[f]=a[f]);return c};
\u03c0.listen=function(a,b,c){if(a){if("function"!=typeof b)return!1}else return!1;a=new EventSource(\u03c0._const.API_ROOT+"pi.io.sse.monitor.php?address="+encodeURI(a));a.addEventListener("message",b,!1);"function"==typeof c&&a.addEventListener("error",c,!1);return a};
\u03c0.readstream=function(a,b,c){if(!\u03c0.session._connected&&"function"==typeof c)return c.call(this,"Error: No session in readstream()."),!1;if("function"==typeof b)return \u03c0.session.addStreamListener(a,b,c);"function"==typeof c&&c.call(this,"Error: Argument #2 is not a function in readstream().");return!1};
\u03c0.readqueue=function(a,b,c){if(!\u03c0.session._connected&&"function"==typeof c)return c.call(this,"Error: No session in readqueue()."),!1;if("function"==typeof b)return \u03c0.session.addStreamListener(a,b,c);"function"==typeof c&&c.call(this,"Error: No listener in readstream().");return!1};
\u03c0.on=function(a,b,c){if("object"==typeof a){var d=0,f;for(f in a)a.hasOwnProperty(f)&&"function"==typeof a[f]&&(d++,\u03c0.on(f,a[f],b,c||!1));return d}0!==a.indexOf("pi.")&&(a="pi."+a);return window.addEventListener(a,b,c)};\u03c0.bind=\u03c0.on;\u03c0.await=function(a,b,c){a=a||!1;c=c||\u03c0._const.DEFAULT_TIMEOUT;return"string"!=typeof a?!1:"pi.app."==a.substring(0,7)?\u03c0.events.subscribe(a,b):\u03c0._send("await",a,c,b)};
\u03c0.read=function(a,b,c){return \u03c0._send("read",a,null,b||!1)};\u03c0.write=function(a,b,c){return \u03c0._send("write",a,b,c)};\u03c0._send=function(a,b,c,d,f){a={command:a,address:b,data:c};"function"==typeof d&&(a.callback=\u03c0.core.callback.add(d));if(\u03c0.session.connected)return \u03c0.session.send(a);pi.log("pi.session not connected! Packet:",a);return!1};
\u03c0.readlist=function(a,b,c){var d={address:a};return"function"!=typeof b?(pi.log("Error : callback is not a function in readlist()."),"function"==typeof c&&c.call(this,"callback is not a function in readlist()."),!1):\u03c0._send("list",a,d,b,c)};
\u03c0.readdata=function(a,b,c){var d={address:a};return"function"!=typeof b?(pi.log("Error : callback is not a function in readdata()."),"function"==typeof c&&c.call(this,"callback is not a function in readdata()."),!1):\u03c0._send("data.list",a,d,b,c)};\u03c0.readfile=function(a,b,c){return \u03c0._send("file.read",address,{fileaddress:a,filetype:b},c)};
\u03c0.require=function(a,b,c,d,f){var g=!0;if(1<=a.indexOf(" ")){a=a.split(" ");for(var e=0;e<a.length;e++)g&=\u03c0.require(a[e],b,c,null,f);g&&"function"==typeof d&&d.call(this);return g}if(\u03c0.loaded[a.replace(/\./g,"_")])return"function"==typeof d&&d.call(this),!0;g=document.getElementsByTagName("head")[0]||document.documentElement;e=document.createElement("script");e.async=b||!1;e.defer=c||!1;0<=a.indexOf("/")?e.src=a:e.src="../../assets/js/pi."+a+".js";e.modname=a.replace(/\./g,"_");e.callback=
d||!1;e.onerror=f||\u03c0.log;\u03c0.timer.start(a);e.onload=function(){\u03c0.loaded[this.modname]={time:(new Date).getTime(),loadtime:\u03c0.timer.stop(this.modname)};"function"==typeof this.callback&&this.callback.call(this,this.modname)};return!!g.insertBefore(e,g.firstChild)};
\u03c0.timer={timers:{},start:function(a,b,c){var d=a.replace(/\./g,"_"),f=\u03c0.timer.timers,g=\u03c0.timer.timers[d]||!1,e=\u03c0.events||!1;b=b||!1;c=c||1E3;var k=!1;g&&pi.log("Warning: starting timer "+a+" for a second time. Results unpredictable.");"function"==typeof b&&(k=setInterval(b,c));f[d]={id:a,start:(new Date).getTime(),tickid:k};"function"==typeof e.publish&&e.publish("pi.timer."+a+".start",{event:"start",data:f[d]})},check:function(a){var b=a.replace(/\./g,"_"),c=\u03c0.timer.__items,
d=\u03c0.events||!1,f=f||!1,g=g||1E3,e=!1;\u03c0.timer.__items[b]&&pi.log("Warning: starting timer "+a+" for a second time. Results unpredictable.");"function"==typeof f&&(e=setInterval(f,g));c[b]={id:a,start:(new Date).getTime(),tickid:e};"function"==typeof d.publish&&d.publish("pi.timer."+a+".tick",{event:"tick",data:c[b]})},stop:function(a){var b=\u03c0.timer.history,c=\u03c0.timer.timers[a.replace(/\./g,"_")]||!1;if(!c)return pi.log("Warning: stopping non-existent timer "+a+". Results unpredictable."),
!1;c.tickid&&(clearInterval(c.tickid),c.tickid=!1,c.ontick=null);c.stop=(new Date).getTime();c.time=c.stop-c.start;b.add(c);return c.time},history:{log:[],add:function(a){\u03c0.timer.history.log.push(a)},list:function(a){\u03c0.timer.history.log.forEach(function(b,c){a&&a.call(c,b)})},clear:function(){var a=\u03c0.timer.history.log;for(\u03c0.events.publish("pi.timer.history.on",["clear"]);a.pop(););}}};
\u03c0.__BOOT={strapped:[],checkIt:function(a){var b=\u03c0.__BOOT;return-1<b.strapped.indexOf(a)?!1:b.strapped.push(a)},strapIt:function(a){var b=a.getAttribute("data-src");"string"==typeof b&&0===b.indexOf("pi.")&&(pi.log("adding classes : "+b.replace("."," ")),a.className+=a.className?" "+b.replace("."," "):b.replace("."," "))}};
\u03c0._bootstrap=function(){\u03c0.timer.start("_bootstrap");var a;(a=document.getElementsByClassName("pi"))&&a.length?pi.log("Bootstrapping : "+a.length+" "+(1===a.length?"element":"elements")):pi.log("No pi elements found : "+a.length);for(var b=0;b<a.length;b++)\u03c0.__BOOT.checkIt(a.item(b))&&\u03c0.__BOOT.strapIt(a.item(b));\u03c0.timer.stop("_bootstrap");pi.events.trigger("pi.ready")};document.addEventListener("DOMContentLoaded",\u03c0._bootstrap);
window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(a){window.clearTimeout(a)};Array.prototype.forEach=Array.prototype.forEach||function(a,b){for(var c=0;c<this.length;c++)a.call(b||this,this[c],c,this)};
Array.prototype.map=Array.prototype.map||function(a,b){for(var c=[],d=0;d<this.length;d++)c.push(a.call(b||this,this[d],d,this));return c};Array.prototype.reduce=Array.prototype.reduce||function(a,b){for(var c=b||0,d=0;d<this.length;d++)c=a(c,this[d],d,this);return c};
function addEvent(a,b,c){a.addEventListener?(a.addEventListener(b,c,!1),EventCache.add(a,b,c)):a.attachEvent?(a["e"+b+c]=c,a[b+c]=function(){a["e"+b+c](window.event)},a.attachEvent("on"+b,a[b+c]),EventCache.add(a,b,c)):a["on"+b]=a["e"+b+c]}
var EventCache=function(){var a=[];return{listEvents:a,add:function(b,c,d){a.push(arguments)},flush:function(){var b,c;for(b=a.length-1;0<=b;--b)c=a[b],c[0].removeEventListener&&c[0].removeEventListener(c[1],c[2],c[3]),"on"!=c[1].substring(0,2)&&(c[1]="on"+c[1]),c[0].detachEvent&&c[0].detachEvent(c[1],c[2]),c[0][c[1]]=null}}}();addEvent(window,"unload",EventCache.flush);
pi._addEvent=function(a,b,c){function d(a){var b=c.apply(this,arguments);!1===b&&(a.stopPropagation(),a.preventDefault());return b}function f(){var b=c.call(a,window.event);!1===b&&(window.event.returnValue=!1,window.event.cancelBubble=!0);return b}a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent("on"+b,f)};
pi.addEventListener=function(a,b,c,d){d=window;a=a||null;b=b||null;c=c||null;"string"!=typeof a&&"string"==typeof b&&(d=a,a=b,b=c);if(a.indexOf)return 0===a.indexOf("pi.")?pi.events.subscribe(a,b):pi._addEvent(d,a,b);pi.log("ERROR: no indexOf, eventaddress is type "+typeof a);pi.log("eventaddress : "+a,a);pi.log("wrong parameters?");pi.log("correct: (eventaddress, callback, capture) OR (element, event, callback)")};
\u03c0.events.onWindowMessage=function(a){pi.log("onWindowMessage : "+a,a);pi.log("data : "+a.data);pi.log("origin : "+a.origin);pi.log("source : "+a.source)};window.addEventListener("message",\u03c0.events.onWindowMessage,!1,!0);\u03c0.str_pad=\u03c0.strPad;\u03c0.is_array=\u03c0.isArray;pi.events.trigger("pi.ready",(new Date).getTime());